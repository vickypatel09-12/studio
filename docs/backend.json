{
  "entities": {
    "Customer": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Customer",
      "type": "object",
      "description": "Represents a customer profile in the Bachat Bank ERP system.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Customer entity."
        },
        "name": {
          "type": "string",
          "description": "The full name of the customer."
        },
        "contactNumber": {
          "type": "string",
          "description": "The contact phone number of the customer."
        },
        "address": {
          "type": "string",
          "description": "The address of the customer."
        },
        "email": {
          "type": "string",
          "description": "The email address of the customer.",
          "format": "email"
        },
        "notes": {
          "type": "string",
          "description": "Any notes relevant to the customer."
        }
      },
      "required": [
        "id",
        "name"
      ]
    },
    "MonthlyDeposit": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "MonthlyDeposit",
      "type": "object",
      "description": "Represents a monthly deposit entry for a customer.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the MonthlyDeposit entity."
        },
        "customerId": {
          "type": "string",
          "description": "Reference to Customer. (Relationship: Customer 1:N MonthlyDeposit)"
        },
        "depositAmount": {
          "type": "number",
          "description": "The amount deposited by the customer for the month."
        },
        "paymentMethod": {
          "type": "string",
          "description": "The method of payment used for the deposit (e.g., cash, check, online transfer)."
        },
        "depositDate": {
          "type": "string",
          "description": "The date the deposit was made.",
          "format": "date-time"
        },
        "month": {
          "type": "string",
          "description": "The month the deposit was made."
        }
      },
      "required": [
        "id",
        "customerId",
        "depositAmount",
        "paymentMethod",
        "depositDate"
      ]
    },
    "Loan": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Loan",
      "type": "object",
      "description": "Represents a loan issued to a customer.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Loan entity."
        },
        "customerId": {
          "type": "string",
          "description": "Reference to Customer. (Relationship: Customer 1:N Loan)"
        },
        "carryForwardLoan": {
          "type": "number",
          "description": "The amount of loan carried forward from the previous period."
        },
        "newLoanAmount": {
          "type": "number",
          "description": "The amount of new loan issued or change in loan amount."
        },
        "interestRate": {
          "type": "number",
          "description": "The interest rate applied to the loan."
        },
        "interestAmount": {
          "type": "number",
          "description": "The calculated interest amount on the loan."
        },
        "paymentMethod": {
          "type": "string",
          "description": "The payment method used for loan installments."
        },
        "loanDate": {
          "type": "string",
          "description": "The date when the loan was issued or updated.",
          "format": "date-time"
        },
        "month": {
          "type": "string",
          "description": "The month the loan was created."
        }
      },
      "required": [
        "id",
        "customerId",
        "carryForwardLoan",
        "newLoanAmount",
        "interestRate",
        "interestAmount",
        "loanDate"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/customers/{customerId}",
        "definition": {
          "entityName": "Customer",
          "schema": {
            "$ref": "#/backend/entities/Customer"
          },
          "description": "Stores customer profiles. Each document represents a customer. Includes denormalized 'customerId' for secure referencing in subcollections.",
          "params": [
            {
              "name": "customerId",
              "description": "The unique identifier for the customer."
            }
          ]
        }
      },
      {
        "path": "/customers/{customerId}/monthlyDeposits/{monthlyDepositId}",
        "definition": {
          "entityName": "MonthlyDeposit",
          "schema": {
            "$ref": "#/backend/entities/MonthlyDeposit"
          },
          "description": "Stores monthly deposit entries for a specific customer. Requires 'customerId' to match the parent customer document. ",
          "params": [
            {
              "name": "customerId",
              "description": "The unique identifier for the customer who made the deposit."
            },
            {
              "name": "monthlyDepositId",
              "description": "The unique identifier for the monthly deposit."
            }
          ]
        }
      },
      {
        "path": "/customers/{customerId}/loans/{loanId}",
        "definition": {
          "entityName": "Loan",
          "schema": {
            "$ref": "#/backend/entities/Loan"
          },
          "description": "Stores loan information for a specific customer. Requires 'customerId' to match the parent customer document.",
          "params": [
            {
              "name": "customerId",
              "description": "The unique identifier for the customer who received the loan."
            },
            {
              "name": "loanId",
              "description": "The unique identifier for the loan."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore data structure is designed to support the Bachat Bank ERP system, focusing on Customers, Monthly Deposits, and Loans. It prioritizes Authorization Independence, Clarity, and predictable data structures. Path-Based ownership is used for most resources. Each path follows the naming convention `/entityName/{entityId}`. For entities owned by a `Customer` such as `MonthlyDeposit` and `Loan`, the paths are structured as `/customers/{customerId}/monthlyDeposits/{monthlyDepositId}` and `/customers/{customerId}/loans/{loanId}` respectively. This structure ensures proper scoping and security. Settings have been removed as they are no longer needed.\n\nAuthorization Independence:\nAuthorization will be managed through Firebase Authentication, with rules enforcing that users can only access data related to their customer accounts or that they have global admin roles. Since this application does not contain user role separation, we rely on path-based ownership.\n\nQAPs (Rules are not Filters):\nSegregation is achieved by using distinct collections for each entity, ensuring that rules can be applied consistently without complex filtering. The path-based ownership for customer-related data (`/customers/{customerId}/...`) ensures that users can only access their own data, supporting secure `list` operations."
  }
}